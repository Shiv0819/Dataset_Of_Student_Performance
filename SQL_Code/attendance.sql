use puneri_pattern_2;
create table Attendance(
	Student_ID int,
    _Subject_ varchar(40),
    Teacher_ID int,
    Dates date,
    Attendance enum("P","A")
    );
INSERT INTO Attendance (Student_ID, _Subject_, Teacher_ID, Dates, Attendance) VALUES
-- Data Science students (Python teacher)
(1, 'Python', 101, '2024-01-21', 'P'),(1, 'Python', 101, '2024-01-23', 'P'),(1, 'Python', 101, '2024-01-25', 'P'),
(5, 'Python', 108, '2024-05-26', 'p'),(5, 'Python', 108, '2024-05-28', 'p'),(5, 'Python', 108, '2024-05-30', 'p'),
(9, 'Python', 108, '2024-09-20', 'P'),(9, 'Python', 108, '2024-09-24', 'P'),(9, 'Python', 108, '2024-09-26', 'A'),
(13, 'Python', 101, '2025-03-13', 'P'),(13, 'Python', 101, '2025-03-20', 'P'),(13, 'Python', 101, '2025-03-22', 'P'),
(17, 'Python', 101, '2025-07-17', 'A'),(17, 'Python', 101, '2025-07-21', 'P'),(17, 'Python', 101, '2025-07-24', 'A'),

-- Data Analysis students (Excel or Tableau , power bi)
(1, 'Excel', 104, '2024-03-21', 'P'),(1, 'Excel', 104, '2024-03-25', 'P'),(1, 'Excel', 104, '2024-03-26', 'P'),
(1, 'Tableau', 105, '2024-04-21', 'P'),(1, 'Tableau', 105, '2024-04-22', 'P'),(1, 'Tableau', 105, '2024-04-23', 'A'),
(1, 'power BI', 109, '2024-05-21', 'P'),(1, 'power BI', 109, '2024-05-22', 'A'),(1, 'power BI', 109, '2024-05-23', 'P'),

(5, 'Excel', 104, '2024-06-19', 'P'),(5, 'Excel', 104, '2024-06-21', 'A'),(5, 'Excel', 104, '2024-06-22', 'P'),
(5, 'power BI', 109, '2024-07-20', 'P'),(5, 'power BI', 109, '2024-07-21', 'P'),(5, 'power BI', 109, '2024-07-22', 'A'),
(5, 'Tableau', 105, '2024-08-12', 'P'),(5, 'Tableau', 105, '2024-08-11', 'P'),(5, 'Tableau', 105, '2024-08-09', 'P'),

(9, 'Excel', 104, '2024-10-20', 'P'),(9, 'Excel', 104, '2024-10-24', 'P'),(9, 'Excel', 104, '2024-10-26', 'A'),
(9, 'Power BI', 109, '2024-11-20', 'P'),(9, 'Power BI', 109, '2024-11-24', 'P'),(9, 'Power BI', 109, '2024-11-26', 'A'),
(9, 'Tableau', 105, '2024-12-20', 'P'),(9, 'Tableau', 105, '2024-12-24', 'P'),(9, 'Tableau', 105, '2024-12-26', 'A'),

(13, 'Excel', 104, '2025-04-13', 'P'),(13, 'Excel', 104, '2025-04-20', 'P'),(13, 'Excel', 104, '2025-04-22', 'P'),
(13, 'Power BI', 109, '2025-05-13', 'P'),(13, 'Power BI', 109, '2025-05-20', 'P'),(13, 'power BI', 109, '2025-05-22', 'P'),
(13, 'Tableau', 105, '2025-06-13', 'P'),(13, 'Tableau', 105, '2025-06-20', 'P'),(13, 'Tableau', 105, '2025-06-22', 'P'),

(17, 'Excel', 104, '2025-08-17', 'A'),(17, 'Excel', 104, '2025-08-21', 'P'),(17, 'Excel', 104, '2025-08-24', 'A'),
(17, 'Power BI', 109, '2025-09-17', 'A'),(17, 'Power BI', 109, '2025-09-21', 'P'),(17, 'Power BI', 109, '2025-09-24', 'A'),
(17, 'Tableau', 105, '2025-10-17', 'A'),(17, 'Tableau', 105, '2025-10-21', 'P'),(17, 'Tableau', 105, '2025-10-24', 'A'),

(2, 'Python', 101, '2024-02-16', 'P'),(2, 'Python', 101, '2024-02-17', 'P'),(2, 'Python', 101, '2024-02-19', 'P'),
(2, 'Excel', 104, '2024-03-16', 'P'),(2, 'Excel', 104, '2024-03-17', 'P'),(2, 'Excel', 104, '2024-03-19', 'P'),
(2, 'Power BI', 109, '2024-04-16', 'P'),(2, 'Power BI', 109, '2024-04-17', 'P'),(2, 'Power BI', 109, '2024-04-19', 'P'),
(2, 'Tableau', 105, '2024-05-16', 'P'),(2, 'Tableau', 105, '2024-05-17', 'P'),(2, 'Tableau', 105, '2024-05-19', 'P'),

(6, 'Python', 108, '2024-06-10', 'P'),(6, 'Python', 108, '2024-06-13', 'P'),(6, 'Python', 108, '2024-06-20', 'P'),
(6, 'Excel', 104, '2024-07-10', 'P'),(6, 'Excel', 104, '2024-07-13', 'P'),(6, 'Excel', 104, '2024-07-20', 'P'),
(6, 'Power BI', 109, '2024-08-10', 'P'),(6, 'Power BI', 109, '2024-08-13', 'P'),(6, 'Power BI', 109, '2024-08-20', 'P'),
(6, 'Tableau', 105, '2024-09-10', 'P'),(6, 'Tableau', 105, '2024-09-13', 'P'),(6, 'Tableau', 105, '2024-09-20', 'P'),

(10, 'Python', 108, '2024-10-05', 'A'),(10, 'Python', 108, '2024-10-07', 'P'),(10, 'Python', 108, '2024-10-10', 'A'),
(10, 'Excel', 104, '2024-11-05', 'P'),(10, 'Excel', 104, '2024-11-07', 'A'),(10, 'Excel', 104, '2024-11-10', 'P'),
(10, 'Power BI', 109, '2024-12-05', 'P'),(10, 'Power BI', 109, '2024-12-07', 'P'),(10, 'Power BI', 109, '2024-12-10', 'A'),
(10, 'Tableau', 105, '2025-01-05', 'P'),(10, 'Tableau', 105, '2025-01-07', 'P'),(10, 'Tableau', 105, '2025-01-10', 'A'),

(14, 'Python', 101, '2025-04-21', 'P'),(14, 'Python', 101, '2025-04-23', 'P'),(14, 'Python', 101, '2025-04-25', 'P'),
(14, 'Excel', 104, '2025-05-21', 'A'),(14, 'Excel', 104, '2025-05-23', 'P'),(14, 'Excel', 104, '2025-05-25', 'P'),
(14, 'Power BI', 109, '2025-06-21', 'A'),(14, 'Power BI', 109, '2025-06-23', 'P'),(14, 'Power BI', 109, '2025-06-25', 'P'),
(14, 'Tableau', 105, '2025-07-21', 'P'),(14, 'Tableau', 105, '2025-07-23', 'P'),(14, 'Tableau', 105, '2025-07-25', 'P'),

(18, 'Python', 101, '2025-08-03', 'A'),(18, 'Python', 101, '2025-08-05', 'P'),(18, 'Python', 101, '2025-08-07', 'P'),
(18, 'Excel', 104, '2025-09-03', 'P'),(18, 'Excel', 104, '2025-09-05', 'P'),(18, 'Excel', 104, '2025-09-07', 'A'),
(18, 'Power BI', 109, '2025-10-03', 'A'),(18, 'Power BI', 109, '2025-10-05', 'A'),(18, 'Power BI', 109, '2025-10-07', 'P'),
(18, 'Tableau', 105, '2025-11-03', 'P'),(18, 'Tableau', 105, '2025-11-05', 'P'),(18, 'Tableau', 105, '2025-11-07', 'P'),



-- AWS students
(3, 'AWS', 106, '2025-08-01', 'P'),(3, 'AWS', 106, '2025-08-01', 'P'),(3, 'AWS', 106, '2025-08-01', 'P'),
(7, 'AWS', 106, '2025-08-02', 'A'),(7, 'AWS', 106, '2025-08-02', 'A'),(7, 'AWS', 106, '2025-08-02', 'A'),
(12, 'AWS', 106, '2025-08-03', 'P'),(12, 'AWS', 106, '2025-08-03', 'P'),(12, 'AWS', 106, '2025-08-03', 'P'),
(16, 'AWS', 106, '2025-08-03', 'P'),(16, 'AWS', 106, '2025-08-03', 'P'),(16, 'AWS', 106, '2025-08-03', 'P'),
(19, 'AWS', 106, '2025-08-04', 'A'),(19, 'AWS', 106, '2025-08-04', 'A'),(19, 'AWS', 106, '2025-08-04', 'A'),

-- Full Stack Development students (Java )
(15, 'java', 110, '2025-08-02', 'P'),(15, 'java', 110, '2025-08-02', 'P'),(15, 'java', 110, '2025-08-02', 'P'),
(4, 'Java', 110, '2025-08-01', 'P'),(4, 'Java', 110, '2025-08-01', 'P'),(4, 'Java', 110, '2025-08-01', 'P'),
(11, 'Java', 110, '2025-08-02', 'A'),(11, 'Java', 110, '2025-08-02', 'A'),(11, 'Java', 110, '2025-08-02', 'A'),
(20, 'Java', 110, '2025-08-02', 'P'),(20, 'Java', 110, '2025-08-02', 'P'),(20, 'Java', 110, '2025-08-02', 'P');

select * from Attendance;

SELECT *,ROUND((Present_Count/(Present_Count + Absent_Count))*100,2) as Attendance_Percentage FROM (SELECT 
    Student_ID,
    _Subject_,
    SUM(CASE WHEN Attendance='P' then 1 else 0 end) aS Present_Count,
    SUM(CASE WHEN Attendance='A' then 1 else 0 end)  AS Absent_Count
FROM 
    Attendance

GROUP BY 
    Student_ID,_Subject_
    order by Student_ID) as Attendance ;
    
    
show tables;
drop table Attendance1;    
drop table attendance;